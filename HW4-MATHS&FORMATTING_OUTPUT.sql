--creati o mica baza de date formata din 1-2 tabele in care pt un N de la 1 la 7 sa stocati rezultatele:
--sqrt(N); 3^N; -1 * N; semnul operatiei(3^N- e ^N)

DROP TABLE NUMERE;
CREATE TABLE NUMERE(
	NUMAR NUMBER(1) PRIMARY KEY,
	RADICAL NUMBER(5,2),
	NEGATIV NUMBER(1),
	SEMN NUMBER(1)
);

NSERT INTO NUMERE VALUES(1, 1, 1, 1);
INSERT INTO NUMERE VALUES(2, 1, 1, 1);
INSERT INTO NUMERE VALUES(3, 1, 1, 1);
INSERT INTO NUMERE VALUES(4, 1, 1, 1);
INSERT INTO NUMERE VALUES(5, 1, 1, 1);
INSERT INTO NUMERE VALUES(6, 1, 1, 1);
INSERT INTO NUMERE VALUES(7, 1, 1, 1);


UPDATE NUMERE SET RADICAL = SQRT(NUMAR),
NEGATIV =-NUMAR,
SEMN = SIGN(POWER(3,NUMAR) - EXP(NUMAR));


SELECT * FROM NUMERE;

--sa se creeze o tabela de nume in care introduceti 10 inregistrari
--sa se actualizeze numele din tabela astfel: pt toate aparitiile unei litere care apartine(A:I) sa se transforme in (1:9)

DROP TABLE NUMEX;

CREATE TABLE NUMEX(
	ID NUMBER(2) PRIMARY KEY,
	NUME VARCHAR(50));

INSERT INTO NUMEX VALUES(1, 'ANCA');
INSERT INTO NUMEX VALUES(2, 'ANCA2');
INSERT INTO NUMEX VALUES(3, 'ANCA3');
INSERT INTO NUMEX VALUES(4, 'ANCA4');
INSERT INTO NUMEX VALUES(5, 'ANCA5');
INSERT INTO NUMEX VALUES(6, 'ANCA6');
INSERT INTO NUMEX VALUES(7, 'ANCA7');
INSERT INTO NUMEX VALUES(8, 'ANCA8');
INSERT INTO NUMEX VALUES(9, 'ANCA9');
INSERT INTO NUMEX VALUES(10, 'ANCA10');

UPDATE NUMEX SET NUME = TRANSLATE(NUME, 'ABCDEFGHI', '123456789');

SELECT * FROM NUMEX;


-- Select al carui rezultat sa se prezinte sub f urmatoare:
--nume1 nume10
'
'
'
--nume2 nume9
--nume3 nume8
SELECT A.NUME, B.NUME FROM NUMEX A INNER JOIN NUMEX B ON 1=1
WHERE A.ID + B.ID = 11
AND A.ID <= B.ID;

--Data urmatoarei zile de sambata de dupa Paste
--Pastele asta - Paste trecut = x nr zile
SELECT NEXT_DAY('12-APR-2015', 'SATURDAY' ) FROM DUAL;

SELECT TO_DATE('12-APR-2015') - TO_DATE('20-APR-2014') FROM DUAL;

DROP TABLE PENALIZARI;
DROP TABLE ANGAJAT;
DROP TABLE DEPARTAMENT;


CREATE TABLE DEPARTAMENT(
	ID_DEPARTAMENT NUMBER(2) PRIMARY KEY,
	DEN_DEPART VARCHAR(50),
	ID_SEF NUMBER(2));

CREATE TABLE ANGAJAT(
	ID_ANGAJAT NUMBER(2) PRIMARY KEY,
	NUME VARCHAR2(50),
	DATA_ANGAJARE DATE,
	SALARIU NUMBER(6),
	ID_DEPART NUMBER(2) REFERENCES DEPARTAMENT(ID_DEPARTAMENT));


CREATE TABLE PENALIZARI(
	ID_ANGAJAT NUMBER(2) REFERENCES ANGAJAT(ID_ANGAJAT),
	PENALIZARE NUMBER(3));


INSERT INTO DEPARTAMENT VALUES(1, 'HR', 2);
INSERT INTO DEPARTAMENT VALUES(2, 'FIN', 3);
INSERT INTO DEPARTAMENT VALUES(3, 'IT', 4);
INSERT INTO DEPARTAMENT VALUES(4, 'ADM', 5);

INSERT INTO ANGAJAT VALUES(1, 'HORIA', TO_DATE('12-APR-2014'), 100, 1);
INSERT INTO ANGAJAT VALUES(2, 'FLORIN', TO_DATE('14-APR-2014'), 1002, 2);
INSERT INTO ANGAJAT VALUES(3, 'DANA', TO_DATE('16-APR-2014'), 200, 3);
INSERT INTO ANGAJAT VALUES(4, 'ANCA', TO_DATE('17-APR-2014'), 223, 4);
INSERT INTO ANGAJAT VALUES(5, 'ANA', TO_DATE('18-APR-2014'), 223, 3);
INSERT INTO ANGAJAT VALUES(6, 'MONICA', TO_DATE('25-APR-2014'), 223, 3);
INSERT INTO ANGAJAT VALUES(7, 'MIHAI', TO_DATE('11-APR-2014'), 223, 4);
INSERT INTO ANGAJAT VALUES(8, 'MARIAN', TO_DATE('10-APR-2014'), 223, 1);
INSERT INTO ANGAJAT VALUES(9, 'ION', TO_DATE('29-APR-2014'), 223, 4);
INSERT INTO ANGAJAT VALUES(10, 'IONELA', TO_DATE('27-APR-2014'), 223, 2);


INSERT INTO PENALIZARI VALUES(1, 23);
INSERT INTO PENALIZARI VALUES(2, 200);
INSERT INTO PENALIZARI VALUES(5, 40);
INSERT INTO PENALIZARI VALUES(9, 25);

--pt fiecare departament denumirea, nr_angajatilor, si suma penalizarilor
--daca suma  e 0, afisati 0

SELECT A.DEN_DEPART, COUNT(B.ID_ANGAJAT), SUM(NVL(C.PENALIZARE, 0)) 
FROM DEPARTAMENT A, ANGAJAT B,  PENALIZARI C WHERE 
A.ID_DEPARTAMENT = B.ID_DEPART AND B.ID_ANGAJAT = C.ID_ANGAJAT(+)  GROUP BY A.DEN_DEPART;



--pt toti sefii de daprtament afisati numele, salariul si suma salariatilor din departament 
SELECT A.NUME, A.SALARIU, SUM(B.SALARIU) 
FROM ANGAJAT A, ANGAJAT B, DEPARTAMENT C 
WHERE A.ID_ANGAJAT = C.ID_SEF AND B.ID_DEPART = C.ID_DEPARTAMENT
GROUP BY A.NUME, A.SALARIU;


--pt toti angaatii din dep celui mai recent anagajat -- numele nvl (penalizare) si nume sef

TTITLE 'LISTA ANGAJATILOR DIN DEPARTAMENT'
BTITLE 'DOMNULUI DIRECTOR GENERAL'
COL NUME FORMAT A20 HEADING 'ANGAJAT'
COL PENALIZARE FORMAT 0999 HEADING 'PENALIZARE'
COL ID_SEF FORMAT 0999 HEADING 'ID_SEF'
COL NUME_SEF FORMAT A20 HEADING 'NUME_SEF'
SELECT A.NUME AS ANGAJAT, NVL(B.PENALIZARE,0) AS PENALIZARE, C.ID_SEF AS ID_SEF,  T.NUME AS NUME_SEF
FROM ANGAJAT A, PENALIZARI B, DEPARTAMENT C, ANGAJAT T
WHERE 
	C.ID_DEPARTAMENT = A.ID_DEPART
AND
	A.ID_ANGAJAT = B.ID_ANGAJAT(+)
AND
	C.ID_DEPARTAMENT = (SELECT D.ID_DEPART FROM ANGAJAT D WHERE D.DATA_ANGAJARE = (SELECT MAX(E.DATA_ANGAJARE) FROM ANGAJAT E))
AND
	T.ID_ANGAJAT = C.ID_SEF;

CLEAR BREAKS
CLEAR COLUMNS
TTITLE OFF
BTITLE OFF



